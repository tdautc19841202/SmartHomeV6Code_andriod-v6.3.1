<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<title>镜面触屏玻璃门锁</title>
		<link rel="stylesheet" href="../../source/mui/css/mui.min.css">
		<script src="../../source/mui/js/mui.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/base.css" />
		<link rel="stylesheet" type="text/css" href="css/device.css" />
		<script src="js/plus.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/tools.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/gatewayCmd.js" type="text/javascript" charset="utf-8"></script>
		<script src="data/moreSetting.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../source/js/rem.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../source/js/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="lang/lang.js" type="text/javascript" charset="utf-8"></script>
		<link rel="stylesheet" type="text/css" href="../../skinSource/css/skin.css" />
		<script src="../../source/js/rem.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<style type="text/css">
		.hintBox {
			width: 80%;
			margin-left: 10%;
			height: 18rem;
			background-color: white;
			border-radius: 5px;
			margin-top: 250px;
		}
		
		.hintBox div:nth-child(1) {
			width: 100%;
			text-align: left;
			font-size: 18px;
			border-bottom: 1px solid;
			height: 13rem;
		}
		
		.hintBox div:nth-child(2) {
			float: left;
			text-align: center;
			height: 5rem;
			width: 49%;
			line-height: 5rem;
			border-right: 1px solid;
		}
		
		.hintBox div:nth-child(3) {
			float: left;
			text-align: center;
			height: 5rem;
			width: 49%;
			line-height: 5rem;
			color: green;
		}
		
		.hintBox p {
			padding-top: 5rem;
			padding-left: 2rem;
			padding-right: 2rem;
			font-size: 2rem;
		}
	</style>

	<body>
		<header class="header">
			<div class="header_top iponeXclass">
				<a id="back"></a>
				<a class="deviceName autoSwitchLanguager" key =""></a>
				<a class="more"></a>
			</div>
		</header>
		<div class="lockbackimageview">
			<section class="lockPWDInput">
				<i class="lockPWDInputBg">
		</i>
			</section>
			<section class="lockStateNotice">
				<a class="autoSwitchLanguager" key="device_69_txt_06">请输入密码</a>
			</section>
			<section class="lockKeyBoard">
				<a href="javascript:;"><button>1</button></a>
				<a href="javascript:;"><button>2</button></a>
				<a href="javascript:;"><button>3</button></a>
				<a href="javascript:;"><button>4</button></a>
				<a href="javascript:;"><button>5</button></a>
				<a href="javascript:;"><button>6</button></a>
				<a href="javascript:;"><button>7</button></a>
				<a href="javascript:;"><button>8</button></a>
				<a href="javascript:;"><button>9</button></a>
				<a href="javascript:;"><button id="lockKeyBoard_Clean"></button></a>
				<a href="javascript:;"><button>0</button></a>
				<a href="javascript:;"><button id="lockKeyBoard_backspace"></button></a>
			</section>
			<section class="" style="position: absolute;bottom: 8%;width: 100%;height: 3.5rem;text-align: center">
				<p class="lockDoor autoSwitchLanguager" key="device_69_txt_07" style="border-radius:2.5rem;background-color: #777777;margin-left: 33%;color: white;width: 34%;height: 3.5rem;line-height: 3.5rem;font-size: 1.5rem;
">点击上锁</p>
			</section>
			<!--<section class="" style="margin-top: 3rem;width: 100%;height: 5rem;text-align: center">-->
				<!--<p class="debug" style="border-radius:2.5rem;background-color: green;margin-left: 30%;color: white;width: 40%;height: 5rem;line-height: 5rem;font-size: 1.5rem;-->
<!--">设置密码</p>-->
			<!--</section>-->
			<section class="mask_layer" style="display:none;"><i></i><span class="autoSwitchLanguager" key="offLine">设备已离线</span></section>
			<section class="saveToast" style="display:none;z-index:999">
				<div><i><em class="rotate"></em></i></div>
			</section>
			<section class="device_mask_Layer" style="display:block;">
			</section>
			<!--强制设置密码-->
			<section class="firstSetPWD" style="display:none;z-index:998" id="firstSetPWD">
				<div class="pwdInputToast">
					<span key="device_69_txt_02" class="autoSwitchLanguager">请先设置手机开门密码</span>
					<div class="name"><input id="setPWDInput" class="autoSwitchLanguager" maxlength="6" type="text" placeholder="" onkeyup="value=value.replace(/[^\d]/g,'')"/><i class="look"></i></div>
					<div class="choose_1">
						<a href="javascript:;" key="device_69_buttun_01" class="autoSwitchLanguager setPwdBtn">确定</a>
					</div>
				</div>
			</section>
			<!--查询锁状态超时-->
			<section class="timeOutToastDiv" style="display:none;z-index:999" id="showTimeOutView">
				<div class="timeOutToast">
					<span key="device_69_txt_01" class="autoSwitchLanguager">连接超时</span>
					<div class="choose_1">
						<a href="javascript:;" key="device_69_buttun_01" class="autoSwitchLanguager timeOutOK">确定</a>
					</div>
				</div>
			</section>
		</div>
	</body>

	<script src="js/doorControl.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery.md5.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/handle.js"></script>
	<script>
		initlan()
        mui.init({});
		var info = window.sysfun;
		info.init("V6DoorLockVOC");
		var deviceInfo;
		var endpointNumber;
		var endpointType;
		var clusterId;
		var cameraId;
		var wifiName;
		var shadow = document.getElementsByClassName("mask_layer")[0];
		var shadow_noWifi = document.getElementsByClassName("mask_layer")[1];
		var deviceName = document.getElementsByClassName("deviceName")[0];

        var isClick = true;//输入密码

        $(".look").on("click", function() {
            if(isClick == true) {
                $(this).css({ "background": "url(fonts/icon_look.png) no-repeat center center", "background-size": "2rem auto" })
                $(this).siblings("input").attr("type", "text")
                isClick = false
            } else {
                $(this).css({ "background": "url(fonts/icon_close.png) no-repeat center center", "background-size": "2rem auto" })
                $(this).siblings("input").attr("type", "password")
                isClick = true
            }
        })

		showLoading();

        plus.plusReady(function() {
            document.getElementById("setPWDInput").placeholder = languageUtil.getResource("device_69_txt_03");
            plus.gatewayCmd.getDeviceInfo(function(result) {
				deviceInfo = result;
				endpointNumber = result.endpoints[0].endpointNumber;
				endpointType = result.endpoints[0].endpointType;
				clusterId = result.endpoints[0].clusterId;
				devID = result.devID;
				gwID = result.gwID;
				getMoreConfig(devID);
				if(result.mode == 2) {
					shadow.style.display = "block";
				} else {
					shadow.style.display = "none";
				}
                getLockPWDInfo();
				var name = "";
				if(!isNull(result.name)) {
					name = result.name.indexOf("#$default$#") != -1 ? alarmSet_js_01 + result.name.split("#")[2] : result.name;
				}
				deviceName.textContent = name;
				rush_500(devID, gwID);
			});
			document.getElementById("back").addEventListener("click", function() {
				plus.tools.back(function() {});
			});
			document.getElementsByClassName("more")[0].addEventListener("click", function() {
				plus.tools.more(moreSettingData, function() {});
			});
            document.getElementsByClassName("lockDoor")[0].addEventListener("click", function() {
                lockDoor();
            });
            document.getElementsByClassName("setPwdBtn")[0].addEventListener("click", function() {
                //点击确定
				//校验密码
				var inputNum = $("#setPWDInput").val();
                    var pattern = /^[0-9]*$/;
                    if (pattern.test(inputNum) && inputNum.length == 6){
                        setLockPWD(inputNum);
                        showSetPwdLoading();
                    }else{
                        mui.toast(device_69_txt_03);
                    }
            });
            document.getElementsByClassName("timeOutOK")[0].addEventListener("click", function() {
                //点击确定
                plus.tools.back(function() {});
            });

			function rush_500(dID, gID) {
				plus.gatewayCmd.newDataRefresh(function(result) {
					if(result.cmd == "500" && deviceInfo.devID == result.devID) {
						var name = "";
						if(!isNull(result.name)) {
							name = result.name.indexOf("#$default$#") != -1 ? alarmSet_js_01 + result.name.split("#")[2] : result.name;
						}
						deviceName.textContent = name;
						if(result.mode == 2) {
							shadow.style.display = "block";
						} else if(result.mode == 1) {
							shadow.style.display = "none";
						} else {
							shadow.style.display = "none";
						}
					} else if(result.cmd == "502") {
						var name = "";
						if(!isNull(result.name)) {
							name = result.name;
						}
						deviceName.textContent = name;
					}

					if (result.cmd == "501" && deviceInfo.devID == result.devID){
					    /*	cmd = 501;
    						devID = C1E1BC05004B1200;
    						gwID = 000C43E17629;
    						retCode = 6;*/
					    switch (parseInt(result.retCode)){
                            case 2:
                            {
                                //控制数据格式不正确
                            }
                                break;
                            case 3:
                            {
                                //设备不存在或设备已离线
                            }
                                break;
							case 6:
							{
							    //玻璃门锁开锁失败，密码错误

                                cleanpassword();
                                //密码验证失败
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_09; //"密码错误，请重试"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                                setTimeout(function() {
                                    var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                    notice.textContent = alarmSet_js_03; //"请输入密码"
                                    var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                    lockstate.className = "lockstateClosed";
                                }, 3000);
							}
							break;
						}
					}

					if(dID == result.devID && gID == result.gwID && result.cmd == "500") {
						switch(parseInt(result.mode)) {
							case 0:
								{
									//设备状态变化
									clearTimer();
									shadow.style.display = "none";
									var attributeId = result.endpoints[0].clusters[0].attributes[0].attributeId;
									var attributeValue = result.endpoints[0].clusters[0].attributes[0].attributeValue;
									reloadUI(parseInt(attributeId), parseInt(attributeValue));
								}
								break;
							case 1:
								{
									//设备上线
									shadow.style.display = "none";
									var attributeId = result.endpoints[0].clusters[0].attributes[0].attributeId;
									var attributeValue = result.endpoints[0].clusters[0].attributes[0].attributeValue;
									reloadUI(parseInt(attributeId), parseInt(attributeValue));
								}
								break;
							case 2:
								{
									//设备离线
									shadow.style.display = "block";
								}
								break;
							case 3:
								{
									//设备主动退网
									shadow.style.display = "block";
								}
								break;
							case 4:
								{
									//设备第一次上线
									shadow.style.display = "none";
								}
								break;
							default:
								{

								}
								break;
						}
					}
				})
			}

			function reloadUI(attributeId, attributeValue) {
				switch(attributeId) {
					case 0x0000:
					{
                        //1表示上锁
                        //2表示上保险
                        //3表示解除保险
                        //4表示反锁
                        //5表示解除反锁
                        doorLockStatue(attributeValue);
					}
					break;
                    case 0x8001:
                    {
                        //1表示入侵报警
						//2表示报警解除
                        //3表示破坏报警
                        //4表示密码连续出错
                        //5表示欠压报警
                    }
                        break;
                    case 0x8002:
                    {
                        doorLockVerifyPWD(attributeValue);
                    }
                        break;
                    case 0x8003:
                    {
                        //3表示强制上锁
                        //4表示自动上锁
                        switch(attributeValue) {
                            case 3: {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_10; //"强制上锁"
                                //强制上锁
                                setTimeout(function() {
                                    var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                    notice.textContent = alarmSet_js_03; //"请输入密码"
                                    var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                    lockstate.className = "lockstateClosed";
                                }, 3000);

                            }
                                break;
                            case 4: {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_11 //"自动上锁";
                                //自动上锁
                                setTimeout(function() {
                                    var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                    notice.textContent = alarmSet_js_03; //"请输入密码"
                                    var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                    lockstate.className = "lockstateClosed";
                                }, 3000);
                            }
                                break;
                        }
                    }
                        break;
					case 0x8004:
					{
					    //0:表示没有设置过开锁密码
                        //1:表示已经设置过开锁密码
                        if (attributeValue == 0){
                            hideLoading();
                            showSetPWDView();
						}else {
                            hideSetPWDView();
                            hideLoading();
						}
					}
					break;
                    case 0x8005:
                    {
                        //0:玻璃门锁设置开锁密码成功
                        //1:玻璃门锁设置开锁密码失败，原始密码不正确
                        if (attributeValue == 0){
                            hideSetPwdLoading();
                            getLockPWDInfo();

						}else if (attributeValue == 1){
                            hideSetPwdLoading();
                            getLockPWDInfo();
						}
                    }
                        break;
					default:
					{

					}
						break;
				}
			}
			/*
			 * 锁状态
			 */
			function doorLockStatue(attributeValue) {
				cleanpassword();
				switch(attributeValue) {
					case 1:
						{
							//上锁
                            var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                            notice.textContent = device_69_txt_08; //"已上锁";
                            var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                            lockstate.className = "lockstateOpened";
                            setTimeout(function() {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_03; //"请输入密码"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                            }, 3000);
						}
						break;
					case 2:
						{
							//上保险
							var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
							notice.textContent = alarmSet_js_04; //"上保险"
                            setTimeout(function() {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_03; //"请输入密码"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                            }, 3000);
						}
						break;
					case 3:
						{
							//解除保险
							var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
							notice.textContent = alarmSet_js_05 //"解除保险";
                            setTimeout(function() {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_03; //"请输入密码"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                            }, 3000);
						}
						break;
					case 5:
						{
							//解除反锁
							var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
							notice.textContent = alarmSet_js_06; //"解除反锁"
                            setTimeout(function() {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_03; //"请输入密码"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                            }, 3000);
						}
						break;
					case 4:
						{
							//反锁
							var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
							notice.textContent = alarmSet_js_07; //"门已反锁"
                            setTimeout(function() {
                                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                                notice.textContent = alarmSet_js_03; //"请输入密码"
                                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                                lockstate.className = "lockstateClosed";
                            }, 3000);
						}
						break;
					default:
						{

						}
						break;
				}
			}
			/*
			 * 锁告警
			 */
			function doorLockAlarm(attributeValue) {
				switch(attributeValue) {
					case 1:
						{
							//入侵报警
						}
						break;
					case 2:
						{
							//报警解除
						}
						break;
					case 3:
						{
							//破坏告警
						}
						break;
					case 4:
						{
							//密码连续出错
						}
						break;
					case 5:
						{
							//欠压报警
						}
						break;
					default:
						{

						}
						break;
				}
			}

			/*
			 * 用户开锁信息
			 */
			function doorLockUser(attributeValue) {
				cleanpassword();
				var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
				notice.textContent = alarmSet_js_08; //"门锁已开";
				var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
				lockstate.className = "lockstateOpened";
				setTimeout(function() {
					var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
					notice.textContent = alarmSet_js_03; //"请输入密码"
					var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
					lockstate.className = "lockstateClosed";
				}, 3000);
			}

			/*
			 * 密码验证状态
			 */
			function doorLockVerifyPWD(attributeValue) {
				cleanpassword();

                //密码验证成功
                var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                notice.textContent = alarmSet_js_08; //"门锁已开";
                var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                lockstate.className = "lockstateOpened";
                setTimeout(function() {
                    var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
                    notice.textContent = alarmSet_js_03; //"请输入密码"
                    var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
                    lockstate.className = "lockstateClosed";
                }, 3000);

			}

            var iphoneX = {
                sysFunc: "getItem:",
                room: "iphoneX",
                id: "iphoneX",
                data: ""
            };
            var iStr = '';
            if (!window.v6sysfunc) {
                iStr = prompt(JSON.stringify(iphoneX))
            }
            if (iStr == "iphoneX") {
                $(".lockbackimageview")[0].style.top = "8.8rem";
                $(".mask_layer")[0].style.top = "0.1rem";
            }
		});

		/*
		 * 密码验证状态
		 */
		function doorLockRightJudge(attributeValue) {
			cleanpassword();
			switch(attributeValue) {
				case 1:
					{
						//无线端密码开锁失败 
						var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
						notice.textContent = alarmSet_js_13; //"无线端密码开锁失败 ，请重试";
						var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
						lockstate.className = "lockstateClosed";
					}
					break;
				case 2:
					{
						//密码验证失败
						var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
						notice.textContent = alarmSet_js_09; //"密码错误，请重试"
						var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
						lockstate.className = "lockstateClosed";
						setTimeout(function() {
							var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
							notice.textContent = alarmSet_js_03; //"请输入密码"
							var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
							lockstate.className = "lockstateClosed";
						}, 3000);
					}
					break;
				case 6:
					{
						//动态密码失败
						var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
						notice.textContent = alarmSet_js_14; //"动态密码失败，请重试";
						var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
						lockstate.className = "lockstateClosed";
					}
					break;
				case 10:
					{
						//操作失败
						var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
						notice.textContent = alarmSet_js_15; //"操作失败，请重试";
						var lockstate = document.getElementsByClassName("lockstate")[0].getElementsByTagName("a")[0];
						lockstate.className = "lockstateClosed";
					}
					break;
				default:
					{

					}
					break;
			}
		}

		function clearTimer() {
			if(timer) {
				clearTimeout(timer);
			}
		}

		function cleanpassword() {
			if(openLock) {
				clearTimer();
				var notice = document.getElementsByClassName("lockStateNotice")[0].getElementsByTagName("a")[0];
				notice.textContent = alarmSet_js_16; //"请求超时!";
				openLock = false;
			}
			lockPWD = "";
			var imglength = document.getElementsByClassName("lockPWDInputBg")[0].getElementsByTagName("a").length;
			if(imglength) {
				for(var i = imglength; i > 0; i--) {
					var parent = document.getElementsByClassName("lockPWDInputBg")[0];
					var child = document.getElementsByClassName("lockPWDInputBg")[0].getElementsByTagName("a")[i - 1];
					parent.removeChild(child);
				}
			}
		}
		/*
		 * 设备控制
		 */
		function sendCmd(pwd) {
		    //明文密码加密
			var md5pwd = $.md5(pwd);
			var jsonData = {
				"cmd": "501",
				"gwID": gwID,
				"devID": devID,
				"endpointNumber": endpointNumber,
				"clusterId": 0x0101,
				"commandType": 01,
				"commandId": 0x8004,
				"parameter": [md5pwd],
			};
			plus.gatewayCmd.controlDevice(jsonData, function(result) {
				console.log("result" + result);
			})
		}

		/*
		 * 设备状态查询
		 */
		function getLockPWDInfo() {
            var jsonData = {
                "cmd": "501",
                "gwID": gwID,
                "devID": devID,
                "endpointNumber": endpointNumber,
                "clusterId": 0x0101,
                "commandType": 01,
                "commandId": 0x8001,
            };
            plus.gatewayCmd.controlDevice(jsonData, function(result) {
                console.log("result" + result);
            })
        }

        /*
		 * 设置开锁密码
		 */
        function setLockPWD(pwd) {
            //明文密码加密
            var md5PWD = $.md5(pwd);
            var jsonData = {
                "cmd": "501",
                "gwID": gwID,
                "devID": devID,
                "endpointNumber": endpointNumber,
                "clusterId": 0x0101,
                "commandType": 01,
                "commandId": 0x8002,
                "parameter": [md5PWD],
            };
            plus.gatewayCmd.controlDevice(jsonData, function(result) {
                console.log("result" + result);
            })
        }

        /*
		 * 修改开锁密码
		 */
        function updateLockPWD(oldPWD,newPWD) {
            var oldMD5PWD = $.md5(oldPWD);
            var newMD5PWD = $.md5(newPWD);
            var jsonData = {
                "cmd": "501",
                "gwID": gwID,
                "devID": devID,
                "endpointNumber": endpointNumber,
                "clusterId": 0x0101,
                "commandType": 01,
                "commandId": 0x8003,
                "parameter": [oldMD5PWD,newMD5PWD],
            };
            plus.gatewayCmd.controlDevice(jsonData, function(result) {
                console.log("result" + result);
            })
        }

        /*
		 * 上锁
		 */
        function lockDoor() {
            var jsonData = {
                "cmd": "501",
                "gwID": gwID,
                "devID": devID,
                "endpointNumber": endpointNumber,
                "clusterId": 0x0101,
                "commandType": 01,
                "commandId": 0x8005,
            };
            plus.gatewayCmd.controlDevice(jsonData, function(result) {
                console.log("result" + result);
            })
        }

		function isNull(arg) {
			var isnull = arg == null || arg == undefined || arg == "undefined" || arg == "";
			return isnull;
		}
	</script>

</html>